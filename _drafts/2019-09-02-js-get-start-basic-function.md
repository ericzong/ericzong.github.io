---
layout: post
title: JS入门：函数
category: JS
tags: JS 入门
excerpt: JS入门教程，函数基础知识讲解。
author: Eric Zong
---

* content
{:toc}

# 函数

函数是“可调用对象”，有一个内部属性 `call`，使其可被调用。

函数可拥有属性，其 `length` 属性表示其参数个数。

在整个声明中，如果 `function` 是第一个词，则是函数声明，否则是函数表达式。函数表达式可以是匿名的，而函数声明不可以省略函数名。

立即执行函数表达式（IIFE，Immediately Invoked Function Expression），常见形式有：

```javascript
// 形式一
(function(){...})();
// 形式二
(function(){...}());
```

`Function.prototype` 本身就是一个没有操作的空函数。

# 词法作用域

作用域分为词法作用域和动态作用域，JavaScript 使用前者。

JavaScript 的词法作用域是基于编译器语义（非解释器）。

在 JavaScript 中，每个函数都有自己的作用域。作用域基本上是变量的一个集合以及如何通过名称访问这些变量的规则。只有函数内部的代码才能访问这个函数作用域中的变量。

作用域查找会在找到每一个匹配的标识符时停止。并且只会查找一级标识符（意即不会查找属性链形式访问的属性）。

可以通过eval和with欺骗词法作用域，但会导致性能下降，因为编译时将无法优化作用域查询。

非全局的变量如果被遮蔽了，将无法被访问到。

ES3+，catch分句会创建一个块作用域。

let定义循环变量时，变量在每次迭代都会声明。

# 提升

包括变量和函数在内的所有声明都会在当前作用域任何代码被执行前首先被处理，就好像声明被移动到了作用域的最开始，这称为“提升”。

只有声明本身会被提升，而赋值或其他运行逻辑会留在原地。

函数表达式不会被提升，过早使用会引起TypeError。

函数首先被提升，然后才是变量。因此，要注意重复声明可能引发的问题。

# 闭包

当函数可以记住并访问所在的词法作用域时，就产生了闭包，即使函数是在当前词法作用域之外执行。闭包是对作用域的引用。闭包是一个关于如何在函数作为值按需传递的词法环境中书写代码的标准。

只要使用了回调函数，实际上就是在使用闭包。

闭包是词法作用域和作为值的函数两者的直接结果之一。

> 通常，除非函数被传播到其作用域之外执行，否则即使产生了闭包也并未使用，而仅仅使用了普通的变量查询而已。