---
layout: page
title: package.json参考
permalink: /page/package-json
---

* content
{:toc}

# 依赖

## dependencies

生产（production）依赖，在开发及发布到生产环境时均可用。

不应包含测试工具（test harness）或转换器（transpiler）。

## devDependencies

开发（development）依赖，开发阶段可用。

测试工具（test harness）或转换器（transpiler）通常配置在这里。

## peerDependencies

插件依赖，声明依赖的插件及版本。

> 在 npm1 和 npm2 中，会自动安装该依赖；npm3+ 则不会自动安装，而是报告警告。

## bundledDependencies

绑定依赖，打包发布时会将该依赖一起发布。

## optionalDependencies

可选依赖，即使缺失也不会导致安装失败。

# 语义版本

语义版本，Semantic Versioning, semver。

## 格式

```
major.minor.patch
```

* major：主版本号，API 破坏性或非兼容性修改
* minor：次要版本号，向后兼容新功能
* patch：补丁号，向后兼容 bug 修正

## 精确版本

| 实例   | 说明                   |
| ------ | ---------------------- |
| 1.2.3  | 注意，三部分都必须齐全 |
| v1.2.3 | “v”将被移除            |
| =1.2.3 | “=”将被移除            |

> 通常，精确版本很少使用。毕竟，如果使用精确版本配置，那么在依赖版本升级时就会涉及手动维护依赖版本的问题。

## 版本范围（Version Range）

版本范围（version range） = 比较器（comparator）* n

比较器（comparator） = 操作符（operator）+ 版本（version）

### 原始操作符

| 操作符 | 说明       | 示例     | 示例范围       |
| ------ | ---------- | -------- | -------------- |
| <      | 小于       | \<1.2.3  | [0.0.0, 1.2.3) |
| <=     | 小于等于   | \<=1.2.3 | [0.0.0, 1.2.3] |
| >      | 大于       | \>1.2.3  | (1.2.3, )      |
| >=     | 大于等于   | \>=1.2.3 | [1.2.3, )      |
| =      | 等于，缺省 | =1.2.3   |                |

### 集合运算

| 集合运算        | 示例               | 示例范围                 |
| --------------- | ------------------ | ------------------------ |
| 交集，空格间隔  | \>=1.2.3 \<3.1.4   | [1.2.3, 3.1.4)           |
| 并集，\|\| 间隔 | <1.2.3 \|\| >3.1.4 | [0.0.0, 1.2.3) (3.1.4, ) |

> 通常，如上面实例所示，原始操作符与集合运算常常混合使用。但应用依旧较少。
>
> 不过，集合运算也可以跟下文的高级版本范围混合使用。

### 连字符（Hyphen）范围

| 示例        | 示例范围       | 说明     |
| ----------- | -------------- | -------- |
| 1.2.3-3.1.4 | [1.2.3, 3.1.4] | 双闭区间 |

> 表面上看，连字符范围应该是个完全闭区间。但并非总是如此，如果其起始或结束版本是一个范围，那么，会出现开区间。这种情况，在下文说明混合应用时会讨论到。

### X 范围

| 示例  | 示例范围       | 说明                                          |
| ----- | -------------- | --------------------------------------------- |
| 1.2.x | [1.2.0, 1.3.0) | 补丁号任意，其他固定                          |
| 1.x.3 | [1.0.0, 2.0.0) | 左起第 1 个占位符右边的版本号就没有约束作用了 |

> *、X、x 都是“占位符”。

### 波浪号（Tilde）范围

| 示例   | 示例范围       | 说明     |
| ------ | -------------- | -------- |
| ~1.2.3 | [1.2.3, 1.3.0) | 注意下限 |
| ~1.2.0 | [1.2.0, 1.3.0) |          |
| ~1.0.0 | [1.0.0, 1.1.0) |          |
| ~0.0.0 | [0.0.0, 0.1.0) |          |

> 表面上看，波浪号总是锁定次要版本号。但事实上，如果波浪号后跟的版本只有包含主版本号部分，那么，锁定的是主版本号。这种情况，在下文说明混合应用时会讨论到。
>
> 总之，波浪号更像是从右向左锁定某个部分的版本号。

### 脱字号（Caret）范围

| 示例   | 示例范围       | 说明     |
| ------ | -------------- | -------- |
| ^1.2.3 | [1.2.3, 2.0.0) | 注意下限 |
| ^0.2.3 | [0.2.3, 0.3.0) |          |
| ^0.0.3 | [0.0.3, 0.0.4) |          |
| ^0.0.0 | 0.0.0          | 无意义   |

> 总之，脱字号是从左向右锁定第 1 位非 0 版本号。

### 特殊范围

| 版本             | 说明             |
| ---------------- | ---------------- |
| latest           | 最新版本。慎用！ |
| ""(empty string) | 任意版本。       |
| *、X、x          | 任意版本。       |

> 基本都属于危险的版本范围，实际应用很少。

## 混合应用

| 示例    | 示例范围       | 说明                 |
| ------- | -------------- | -------------------- |
| 1.2.3-3 | [1.2.3, 4.0.0) | 连字符范围出现开区间 |
| ~1      | [1.0.0, 2.0.0) | 锁定主版本号         |

# 参考

[npm-semver](https://docs.npmjs.com/misc/semver)

[语义化版本](https://semver.org/lang/zh-CN/)